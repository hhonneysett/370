@model LibraryAssistantApp.Models.Question_Bank


<div class="panel panel-default">
    <div class="panel-heading"><h4>Possible Answers</h4></div>
    <div class="panel-body">



        <div class="form-horizontal">
            <div class="form-group">
                @Html.LabelFor(model => model.Style_Type_ID, "Style Type", htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.DropDownList("Style_Type_ID",null, "Select a style type", htmlAttributes: new { @class = "form-control", @onchange = "CallChangefunc(this.value)", id = "Style_Type_ID" })

                    <script>
                        function CallChangefunc(val) {
                            var Question_Text = document.getElementById("Question_TextBox").value;
                            var Topic_Seq = document.getElementById("Topic_Dropdownlist").value;
                            var NewTopic = document.getElementById("NewTopic").value;
                            var Topic_Name = document.getElementById("Topic_Name").value;
                            var Topic_Des = document.getElementById("Topic_Des").value;
                            window.location.href = "/Question_Bank/GetDescription?Style_Type_ID=" + val + "&Question_Text=" + Question_Text + "&Topic_Seq=" + Topic_Seq + "&NewTopic=" + NewTopic + "&Topic_Name=" + Topic_Name + "&Topic_Des=" + Topic_Des;
                            }
                    </script>


                    @*@Html.DropDownList("Style_Type_ID", new SelectList(ViewBag.Style_Type_ID), "Select a style type", new { onchange = "form.submit" })*@
                    <label class="text-danger" id="Error_Style_Type_ID"></label>
                    @*@Html.ValidationMessageFor(model => model.Style_Type_ID, "", new { @class = "text-danger" , id = "Error_Style_Type_ID" })*@
                </div>
            </div>

            <div class="form-group">
                @Html.Label( "Description", "Description", htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">

                    @if (ViewBag.Image != null)
                    {
                        @Html.TextArea("Description", htmlAttributes: new { @class = "form-control", id = "StyleType_D", @readonly = true, @Value = (string)ViewBag.Description })
                    }
                    else
                    {
                        @Html.TextArea("No", "Select a style type to see its description", htmlAttributes: new { @class = "form-control", id = "StyleType_D", @readonly = true })
                    }




                  
                                  
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.Style_Type_ID, "Preview", htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">

    @*To display the image*@


                   @if (ViewBag.Image != null)
                   {
                       var base64 = Convert.ToBase64String(ViewBag.Image);
                       var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
                    <img src='@imgSrc' style="max-width:400px; max-height:400px; border:1px solid black;"  />
                   }
                   else
                   {
                        <p>Select a style type for preview</p>
                   }                  


                </div>
            </div>


        </div>

        @if (ViewBag.NewTopic == "YES")
        {
            if (ViewBag.Style_Type_IDName == "Free Text")
            {
                <input type="button" value="Back" class="btn btn-default" onclick="location.href='@Url.Action("Create_Back_From_Create_Question", "Question_Topic", new {ViewBag.Topic_Name, ViewBag.Topic_Des })'" /><input type="submit" value="Save" class="btn btn-default pull-right" onclick="EnableDropDown(); validateInput()" />
            }
            else
            {
                <input type="button" value="Back" class="btn btn-default" onclick="location.href='@Url.Action("Create_Back_From_Create_Question", "Question_Topic", new {ViewBag.Topic_Name, ViewBag.Topic_Des })'" /><input type="submit" value="Next" class="btn btn-default pull-right" onclick="EnableDropDown(); validateInput()" />
            }


        }
        else
        {
            if (ViewBag.Style_Type_IDName == "Free Text")
            {
            <input type="button" value="Cancel" class="btn btn-default" onclick="location.href='@Url.Action("Index")'" />        <input data-toggle="tooltip" data-placement="right" title="Finish creating the new question."  type="submit" value="Save" class="btn btn-default pull-right" onclick="EnableDropDown(); validateInput()" />
            }
            else
            {
                <input type="button" value="Cancel" class="btn btn-default" onclick="location.href='@Url.Action("Index")'" />        <input data-toggle="tooltip" data-placement="right" title="Add possible answers to the question."  type="submit" value="Next" class="btn btn-default pull-right" onclick="EnableDropDown(); validateInput()" />
            }
        }

    </div>
</div>


<script>

    jQuery(document).ready(function ($) {

        if (window.history && window.history.pushState) {

            $(window).on('popstate', function () {
                var hashLocation = location.hash;
                var hashSplit = hashLocation.split("#!/");
                var hashName = hashSplit[1];

                if (hashName !== '') {
                    var hash = window.location.hash;
                    if (hash === '') {
                        //Your code
                       
                        var Topic_Name = document.getElementById("Topic_Name").value;
                        var Topic_Des = document.getElementById("Topic_Des").value;
                        var NewTopic = document.getElementById("NewTopic").value;

                        if (NewTopic == "YES") {
                            window.location.href = "/Question_Topic/Create_Back_From_Create_Question?Topic_Name=" + Topic_Name + "&Topic_Des=" + Topic_Des;
                        }
                        else {
                            window.location.href = "/Question_Bank/Index?";
                        }

                      

                    }
                }
            });

            window.history.pushState('forward', null, './#forward');
        }

    });

</script>


<script>
$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});
</script>